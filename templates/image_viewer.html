<!-- templates/image_viewer.html -->
{% extends 'base_template.html' %}

{% block custom_style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/button_styles.css') }}">
<style>
  .image-wrapper {
    margin: 20px 0;
    background-color: #111;
    padding: 10px;
    border-radius: 8px;
    text-align: center;
  }

  .image-wrapper img {
    max-width: 100%;
    height: auto;
  }

  .image-meta {
    margin: 20px 0;
    line-height: 1.6;
  }

  .similar-section {
    margin: 40px 0 20px;
  }

  .similar-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 16px;
  }

  .similar-card {
    display: block;
    text-decoration: none;
    color: inherit;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    background-color: #fff;
    transition: transform 0.2s ease-in-out;
  }

  .similar-card:hover {
    transform: translateY(-4px);
  }

  .similar-card img {
    width: 100%;
    height: 140px;
    object-fit: cover;
    display: block;
  }

  .similar-card span {
    display: block;
    padding: 8px 10px;
    font-size: 0.9rem;
    text-align: center;
  }

  .action-buttons {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
</style>
{% endblock %}

{% block page_content %}
<div class="container">
  <h1>{{ metadata.name }}</h1>
  {% include 'components/_metadata_panel.html' %}

  <div class="image-wrapper">
    <img src="{{ image.source_url }}" alt="{{ image.name }}">
  </div>

  <div class="image-meta">
    <p><strong>📄 路徑：</strong> {{ image.relative_path }}</p>
    <p><strong>📦 大小：</strong> {{ image.size_display }}</p>
    <p><strong>🕒 更新時間：</strong> {{ image.modified_time }}</p>
    {% if image.original_url %}
    <p>
      <strong>🔗 來源：</strong>
      <a href="{{ image.original_url }}" target="_blank" rel="noopener">
        {{ image.original_url }}
      </a>
    </p>
    {% endif %}
  </div>

  <div class="action-buttons">
    <a href="{{ image.parent_url }}" class="button">返回上一層</a>
    <a href="{{ image.download_url }}" class="button" download>下載圖片</a>
  </div>

  {% if metadata.similar %}
  <div class="similar-section">
    <h2>推薦項目</h2>
    <div class="similar-grid">
      {% for item in metadata.similar %}
      <a class="similar-card" href="{{ item.path }}">
        <img src="{{ item.thumbnail_route }}" alt="{{ item.name }}">
        <span>{{ item.name }}</span>
      </a>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
